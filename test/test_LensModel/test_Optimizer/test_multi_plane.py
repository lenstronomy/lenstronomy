from lenstronomy.LensModel.Optimizer.optimizer import Optimizer
from lenstronomy.Util.util import sort_image_index
import numpy.testing as npt
import numpy as np
import pytest

class TestMultiPlaneOptimizer(object):

    # this data was created with a full LOS realization
    x_pos = [-0.45204,0.11808,-1.05223,0.91451]
    y_pos = [ 0.9932,1.04767,0.10533,-1.21576]
    magnification = [1, 0.374366,0.182709,0.111323]

    # 'simple' lens model is wrong here
    redshift_list_simple = [0.5, 0.5]
    lens_model_list_simple = ['SPEMD', 'SHEAR']
    kwargs_lens_simple = [{'theta_E': 1, 'center_x': 0.01, 'center_y': 0, 'e1': 0.0585665252864011, 'gamma': 2,
                           'e2': 0.08890716633399057}, {'e1': 0.00418890660015825, 'e2': -0.05908846518073248}]

    # this is the lens model used to create the data
    redshift_list_subs = [0.5, 0.5, 0.08089333333333334, 0.08089333333333334, 0.12084000000000002, 0.12084000000000002, 0.14081333333333335, 0.14081333333333335, 0.14081333333333335, 0.14081333333333335, 0.1607866666666667, 0.1607866666666667, 0.1607866666666667, 0.20073333333333337, 0.20073333333333337, 0.20073333333333337, 0.2207066666666667, 0.2207066666666667, 0.2207066666666667, 0.2207066666666667, 0.2207066666666667, 0.24068000000000003, 0.24068000000000003, 0.24068000000000003, 0.24068000000000003, 0.26065333333333335, 0.26065333333333335, 0.26065333333333335, 0.26065333333333335, 0.2806266666666667, 0.2806266666666667, 0.2806266666666667, 0.2806266666666667, 0.30060000000000003, 0.30060000000000003, 0.30060000000000003, 0.30060000000000003, 0.30060000000000003, 0.30060000000000003, 0.30060000000000003, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3205733333333334, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.3405466666666667, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.36052000000000006, 0.3804933333333334, 0.3804933333333334, 0.3804933333333334, 0.3804933333333334, 0.3804933333333334, 0.3804933333333334, 0.3804933333333334, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.40046666666666675, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.42044000000000004, 0.4404133333333334, 0.4404133333333334, 0.4404133333333334, 0.4404133333333334, 0.4404133333333334, 0.4404133333333334, 0.4404133333333334, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.4603866666666667, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.48036000000000006, 0.5003333333333334, 0.5003333333333334, 0.5003333333333334, 0.5003333333333334, 0.5003333333333334, 0.5003333333333334, 0.5203066666666667, 0.5203066666666667, 0.5203066666666667, 0.5203066666666667, 0.5203066666666667, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5402800000000001, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5602533333333334, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.5802266666666668, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6002000000000001, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6201733333333335, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.6401466666666668, 0.66012, 0.66012, 0.66012, 0.66012, 0.66012, 0.66012, 0.66012, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.6800933333333334, 0.7000666666666667, 0.7000666666666667, 0.7000666666666667, 0.7000666666666667, 0.7000666666666667, 0.7000666666666667, 0.7000666666666667, 0.7200400000000001, 0.7200400000000001, 0.7400133333333334, 0.7400133333333334, 0.7400133333333334, 0.7400133333333334, 0.7400133333333334, 0.7599866666666668, 0.7599866666666668, 0.7599866666666668, 0.7599866666666668, 0.7599866666666668, 0.7799600000000001, 0.7799600000000001, 0.7799600000000001, 0.7799600000000001, 0.7999333333333335, 0.7999333333333335, 0.7999333333333335, 0.7999333333333335, 0.7999333333333335, 0.7999333333333335, 0.7999333333333335, 0.8199066666666668, 0.8199066666666668, 0.8199066666666668, 0.8199066666666668, 0.8199066666666668, 0.8398800000000001, 0.8398800000000001, 0.8398800000000001, 0.8398800000000001, 0.8398800000000001, 0.8398800000000001, 0.8398800000000001, 0.8598533333333335, 0.8598533333333335, 0.8798266666666668, 0.8798266666666668, 0.8798266666666668, 0.8798266666666668, 0.8798266666666668, 0.8798266666666668, 0.8998000000000002, 0.8998000000000002, 0.8998000000000002, 0.9197733333333334, 0.9197733333333334, 0.9397466666666668, 0.9397466666666668, 0.9597200000000001, 0.9597200000000001, 0.9597200000000001, 0.9796933333333334, 0.9796933333333334, 0.9796933333333334, 1.01964, 1.01964, 1.0396133333333333, 1.0396133333333333, 1.0396133333333333, 1.0396133333333333, 1.0595866666666667, 1.0595866666666667, 1.0595866666666667, 1.07956, 1.07956, 1.07956, 1.0995333333333335, 1.0995333333333335, 1.1195066666666666, 1.1195066666666666, 1.13948, 1.13948, 1.13948, 1.2992666666666668, 1.2992666666666668, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
    lens_model_list_subs = ['SPEMD', 'SHEAR', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'CONVERGENCE', 'TNFW', 'CONVERGENCE', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW', 'TNFW']
    kwargs_lens_subs = [{'theta_E': 1.2, 'center_x': 0, 'center_y': 0, 'e1': 0.08585665252864011, 'gamma': 2, 'e2': 0.08890716633399057}, {'e1': 0.010418890660015825, 'e2': -0.05908846518073248}, {'theta_Rs': 0.0004721874006939868, 'center_y': 0.9816194883707359, 'center_x': -1.8827813618403586, 'r_trunc': 2.185059267031262, 'Rs': 0.27557137575130997}, {'kappa_ext': -6.47322830346311e-05}, {'theta_Rs': 0.00042226727663097506, 'center_y': -0.13141143157463062, 'center_x': 2.902296271724045, 'r_trunc': 1.3352677006156113, 'Rs': 0.1346881511235642}, {'kappa_ext': -3.183215578165932e-05}, {'theta_Rs': 0.00018660449940008004, 'center_y': -2.1544795713367675, 'center_x': 0.007537853003199489, 'r_trunc': 0.8011872556103804, 'Rs': 0.09975980958172541}, {'theta_Rs': 0.0002727281971830625, 'center_y': 0.9976300386703182, 'center_x': -0.556996640102626, 'r_trunc': 0.972150749112832, 'Rs': 0.12332118378241853}, {'theta_Rs': 0.00038807093742200446, 'center_y': 1.8211391704624498, 'center_x': -1.5301758020166136, 'r_trunc': 1.1654848664818975, 'Rs': 0.1517093302734359}, {'kappa_ext': -5.4788435022445764e-05}, {'theta_Rs': 0.00021377817427120158, 'center_y': -1.5263662719751818, 'center_x': -0.8254422400554128, 'r_trunc': 0.7711635599551045, 'Rs': 0.10649964935982395}, {'theta_Rs': 0.0016152636756764404, 'center_y': 0.7735220409752531, 'center_x': -0.9066487576262018, 'r_trunc': 1.943519474979197, 'Rs': 0.17743619148916875}, {'kappa_ext': -0.00017941010526793263}, {'theta_Rs': 0.0003024558446641311, 'center_y': -2.35834994504146, 'center_x': 1.2908830955545938, 'r_trunc': 0.7423818951342392, 'Rs': 0.10054662676591415}, {'theta_Rs': 0.00018201526056340757, 'center_y': -0.5993354199431189, 'center_x': 0.5833652651158205, 'r_trunc': 0.5933916176707098, 'Rs': 0.09504513533370841}, {'kappa_ext': -2.205971905671679e-05}, {'theta_Rs': 0.0004819261066933826, 'center_y': 0.1929883169395037, 'center_x': 0.2154278074755826, 'r_trunc': 0.8367964873718319, 'Rs': 0.09936948727415451}, {'theta_Rs': 0.0008011800869254694, 'center_y': -0.7065242099167076, 'center_x': -1.6413126416547001, 'r_trunc': 1.0778720351928295, 'Rs': 0.1273815274986399}, {'theta_Rs': 0.00028425261116648296, 'center_y': -0.3392060718103041, 'center_x': 2.7624591461236805, 'r_trunc': 0.6539346761139853, 'Rs': 0.08474996354970611}, {'theta_Rs': 0.0005755347911605291, 'center_y': 1.2665685183011155, 'center_x': 0.9398413618976857, 'r_trunc': 0.9173670264580763, 'Rs': 0.11065295206518433}, {'kappa_ext': -0.0001214613441233162}, {'theta_Rs': 0.00029987853675642924, 'center_y': -2.195008813211932, 'center_x': -0.20501832069126263, 'r_trunc': 0.6013516087761078, 'Rs': 0.06665274230189575}, {'theta_Rs': 0.0002325313663724835, 'center_y': 0.6745762431312434, 'center_x': 2.596841813461087, 'r_trunc': 0.5565139940068726, 'Rs': 0.07935480724401892}, {'theta_Rs': 0.00023864115022113378, 'center_y': 1.1309902397054836, 'center_x': 0.7638642628854577, 'r_trunc': 0.5679194227475247, 'Rs': 0.08434410192758363}, {'kappa_ext': -2.8364888525248767e-05}, {'theta_Rs': 0.0003824561032079405, 'center_y': 1.7829663870582895, 'center_x': -0.5442192951899999, 'r_trunc': 0.6607127054375777, 'Rs': 0.0914411512329493}, {'theta_Rs': 0.00014479858251708865, 'center_y': 0.512678591145771, 'center_x': -1.094381676208324, 'r_trunc': 0.41995090681473596, 'Rs': 0.07000256460754359}, {'theta_Rs': 0.000619970161217997, 'center_y': 2.216095546035851, 'center_x': -0.8505226382236124, 'r_trunc': 0.8242707708288459, 'Rs': 0.10262339296644786}, {'kappa_ext': -5.269932010934271e-05}, {'theta_Rs': 0.00019737438505441706, 'center_y': -1.521086102971407, 'center_x': -0.882466815927521, 'r_trunc': 0.44058870398791894, 'Rs': 0.05814950770669909}, {'theta_Rs': 0.0004924078999785588, 'center_y': -0.970166751437853, 'center_x': 1.5835637631480401, 'r_trunc': 0.6746075641420956, 'Rs': 0.07625746629642002}, {'theta_Rs': 0.00022679841963055172, 'center_y': 0.4137405739416554, 'center_x': 0.1600013604764547, 'r_trunc': 0.4846607412392397, 'Rs': 0.07366450339217373}, {'kappa_ext': -3.286282420204457e-05}, {'theta_Rs': 0.0023009592249502793, 'center_y': 1.729953323137223, 'center_x': -1.6696030794981065, 'r_trunc': 1.3217823498802408, 'Rs': 0.12548764355857156}, {'theta_Rs': 0.010094419920284044, 'center_y': -1.0408731190983085, 'center_x': -0.5140811470800755, 'r_trunc': 2.8355910012465317, 'Rs': 0.29982849463974126}, {'theta_Rs': 0.0010605252130232773, 'center_y': 2.1809501673384797, 'center_x': -1.1668509053666378, 'r_trunc': 0.932158211886304, 'Rs': 0.10531182663382858}, {'theta_Rs': 0.0002741315631793794, 'center_y': 0.8412903810875635, 'center_x': -0.9925384599789926, 'r_trunc': 0.5065613042340311, 'Rs': 0.08141303886921425}, {'theta_Rs': 0.00019883127137156444, 'center_y': 1.2462645753344102, 'center_x': 1.0824833734453876, 'r_trunc': 0.42781659244478504, 'Rs': 0.065461424028372}, {'theta_Rs': 0.0008599104453265273, 'center_y': 1.2334039120680822, 'center_x': 2.2412197961774307, 'r_trunc': 0.8305213751923273, 'Rs': 0.08925494467998742}, {'kappa_ext': -0.0019361133054625111}, {'theta_Rs': 0.0006787508678581163, 'center_y': 2.146616347328838, 'center_x': 1.8604732482593151, 'r_trunc': 0.7102056906877473, 'Rs': 0.0828230938658164}, {'theta_Rs': 0.0014329788842415132, 'center_y': -1.3113619260753877, 'center_x': 2.114672129066865, 'r_trunc': 1.0088886644087092, 'Rs': 0.10575606605862953}, {'theta_Rs': 0.00020143735415824348, 'center_y': 0.3444714166060318, 'center_x': 1.1042174345780087, 'r_trunc': 0.40704173396008575, 'Rs': 0.0619664194471018}, {'theta_Rs': 0.000268094104955876, 'center_y': 1.333434251380989, 'center_x': 0.22783039570966881, 'r_trunc': 0.46633818913277675, 'Rs': 0.06826164982692665}, {'theta_Rs': 0.0008640488195071019, 'center_y': 0.6911970414710706, 'center_x': -0.6952078910355346, 'r_trunc': 0.7518987407511952, 'Rs': 0.06576605362275764}, {'theta_Rs': 0.0004540425077933599, 'center_y': 2.1491400038156803, 'center_x': -0.8306686397926687, 'r_trunc': 0.598405415938267, 'Rs': 0.08114050122254207}, {'theta_Rs': 0.0009020258659075944, 'center_y': -0.20396048783263135, 'center_x': -1.0952752291171464, 'r_trunc': 0.7979338198527904, 'Rs': 0.08244622355922407}, {'theta_Rs': 0.0006079447388729327, 'center_y': 1.0216676825837832, 'center_x': -0.5486790641907544, 'r_trunc': 0.6865078223767596, 'Rs': 0.08899285482239273}, {'theta_Rs': 0.0002496951615758342, 'center_y': -1.9748817545311743, 'center_x': -1.5505176166792465, 'r_trunc': 0.4453857464238534, 'Rs': 0.06157929007276925}, {'kappa_ext': -0.00025295053986512694}, {'theta_Rs': 0.005265765952494305, 'center_y': -1.0778967081915205, 'center_x': -0.524859618800336, 'r_trunc': 1.790915663965611, 'Rs': 0.16739017450125476}, {'theta_Rs': 0.00047593640480149055, 'center_y': -1.6081762388235818, 'center_x': 1.1701446186189646, 'r_trunc': 0.5787264218914863, 'Rs': 0.07613368068386461}, {'theta_Rs': 0.00034012396456878136, 'center_y': 0.13369827774401194, 'center_x': -1.0306815907222966, 'r_trunc': 0.49942922757012603, 'Rs': 0.07343200976333795}, {'theta_Rs': 0.00018919760073754722, 'center_y': 1.4080788155029285, 'center_x': -1.5060118432843883, 'r_trunc': 0.3709931884628693, 'Rs': 0.05334213486802443}, {'theta_Rs': 0.00015702731056067354, 'center_y': -1.3579581874719528, 'center_x': 2.395603818920531, 'r_trunc': 0.34886807031412104, 'Rs': 0.06047159561105406}, {'theta_Rs': 0.0003420283362966358, 'center_y': -0.5493276313901977, 'center_x': 1.514021368655928, 'r_trunc': 0.5122420732331135, 'Rs': 0.08597890134175057}, {'theta_Rs': 0.0002032033126631299, 'center_y': 0.404920696372931, 'center_x': -0.7043125946909324, 'r_trunc': 0.3877732311004894, 'Rs': 0.05848503275781141}, {'kappa_ext': -0.0005680245099276415}, {'theta_Rs': 0.000235238550898749, 'center_y': -0.12996363245532078, 'center_x': 0.9021786173503015, 'r_trunc': 0.3931736861998805, 'Rs': 0.055506343290608884}, {'theta_Rs': 0.0004421722395790794, 'center_y': -2.7914112007034753, 'center_x': 0.7217698473390425, 'r_trunc': 0.5332197099392586, 'Rs': 0.07102998680682647}, {'theta_Rs': 0.0003240175775434722, 'center_y': 0.4081715276055086, 'center_x': -0.3689503380336575, 'r_trunc': 0.45246523992250876, 'Rs': 0.05759841653160611}, {'theta_Rs': 0.0004646937808099141, 'center_y': -0.7026923357552053, 'center_x': 2.5162241989394074, 'r_trunc': 0.5592797412874477, 'Rs': 0.08441969168490382}, {'theta_Rs': 0.00780185936345772, 'center_y': 0.7683217484709406, 'center_x': 2.617993344713135, 'r_trunc': 2.1000457590450194, 'Rs': 0.2052665973619658}, {'theta_Rs': 0.0017556241920738797, 'center_y': 2.1394643285272466, 'center_x': -0.5281965090629549, 'r_trunc': 1.0208052461322594, 'Rs': 0.11153877805225025}, {'theta_Rs': 0.0016443547821251496, 'center_y': 2.0594244106620936, 'center_x': 1.7195594116315291, 'r_trunc': 0.9989335854538863, 'Rs': 0.11505664638290615}, {'theta_Rs': 0.00040759421738985937, 'center_y': 2.884174225993849, 'center_x': -0.31607387902551976, 'r_trunc': 0.508514946930474, 'Rs': 0.06541530302338586}, {'kappa_ext': -0.0011760074165533623}, {'theta_Rs': 0.00015347334441446467, 'center_y': 1.979838852343165, 'center_x': 2.134292972288404, 'r_trunc': 0.3093076198194494, 'Rs': 0.0482638109853637}, {'theta_Rs': 0.00015377644933070752, 'center_y': 1.278802792922511, 'center_x': -0.7771012464720137, 'r_trunc': 0.3227176312413792, 'Rs': 0.06600680838698904}, {'theta_Rs': 0.00021159294200581022, 'center_y': 1.451059567226229, 'center_x': 0.9948512785324676, 'r_trunc': 0.37154472302880237, 'Rs': 0.06672308191113277}, {'theta_Rs': 0.0003451338928631752, 'center_y': 2.5490530743848367, 'center_x': 0.36088302763030145, 'r_trunc': 0.4543126422382576, 'Rs': 0.06310582796502547}, {'theta_Rs': 0.0006671283355194487, 'center_y': 2.875768163418782, 'center_x': -0.776304967848695, 'r_trunc': 0.5926420609157631, 'Rs': 0.06020176246703946}, {'theta_Rs': 0.0002263052349135026, 'center_y': 0.9351230842097151, 'center_x': -1.7991627162855541, 'r_trunc': 0.3777480341036893, 'Rs': 0.06096990679965419}, {'kappa_ext': -5.142655435084205e-05}, {'theta_Rs': 0.0008485249604836712, 'center_y': 1.9402225016837273, 'center_x': -2.022236055986689, 'r_trunc': 0.6574055226145324, 'Rs': 0.07486739695890296}, {'theta_Rs': 0.0012890908141008786, 'center_y': 0.223035597777486, 'center_x': -0.9340774470375762, 'r_trunc': 0.7969103116404521, 'Rs': 0.08392258678270678}, {'theta_Rs': 0.0010779589395587268, 'center_y': 0.13694924487691468, 'center_x': -0.6009547438110405, 'r_trunc': 0.7693038727634604, 'Rs': 0.10591513082092245}, {'theta_Rs': 0.0005414258988838914, 'center_y': -1.7018583566867624, 'center_x': -0.2380705307622414, 'r_trunc': 0.5354906905123383, 'Rs': 0.06713638837623805}, {'theta_Rs': 0.00021017335855718023, 'center_y': 1.2930054046804966, 'center_x': 2.700977428616592, 'r_trunc': 0.3317374381474817, 'Rs': 0.0404180975862575}, {'theta_Rs': 0.0014841080244278925, 'center_y': 0.6815701117677506, 'center_x': -2.1925582191252575, 'r_trunc': 0.8805957080132613, 'Rs': 0.10672431712540469}, {'theta_Rs': 0.0017782328119284516, 'center_y': -0.9398686422833621, 'center_x': 0.48240767842313426, 'r_trunc': 0.9002410195796944, 'Rs': 0.07980105409204083}, {'theta_Rs': 0.000740200354867776, 'center_y': 0.010931929084516302, 'center_x': -2.6047271402397727, 'r_trunc': 0.6275111530294607, 'Rs': 0.07956493800354512}, {'theta_Rs': 0.001190169641900275, 'center_y': -1.9957331100943076, 'center_x': 2.1716744214373667, 'r_trunc': 0.7547790520349001, 'Rs': 0.07446083114507454}, {'kappa_ext': -0.0004137725033132601}, {'theta_Rs': 0.0003027338760620166, 'center_y': 1.8460945251718732, 'center_x': -0.8082072521255567, 'r_trunc': 0.4030165329144031, 'Rs': 0.06453590576239822}, {'theta_Rs': 0.0005568825143894816, 'center_y': 1.8790381561175238, 'center_x': -0.3249896179708021, 'r_trunc': 0.543182031585363, 'Rs': 0.08382800353691447}, {'theta_Rs': 0.0013767200751673724, 'center_y': -0.013929693464086495, 'center_x': -1.168108201823188, 'r_trunc': 0.7379601381310467, 'Rs': 0.057164366982593875}, {'theta_Rs': 0.0007556995299711728, 'center_y': -0.5975556644758767, 'center_x': -0.07518359388782583, 'r_trunc': 0.6081559728048159, 'Rs': 0.07580394257072665}, {'theta_Rs': 0.0005537482008020792, 'center_y': -2.3614180807513723, 'center_x': -0.3970391533078315, 'r_trunc': 0.5323880070582395, 'Rs': 0.07459680257832027}, {'theta_Rs': 0.0011845945446620218, 'center_y': 1.8691006506295462, 'center_x': -1.1972297547877986, 'r_trunc': 0.7688229141590545, 'Rs': 0.10069129207539594}, {'theta_Rs': 0.0004126936145450403, 'center_y': 1.0041528750697855, 'center_x': -2.4699372591028785, 'r_trunc': 0.44628259399716175, 'Rs': 0.05371472953804137}, {'theta_Rs': 0.00019590672607279973, 'center_y': -1.5931872178905613, 'center_x': 0.24788364905824065, 'r_trunc': 0.32261306463379297, 'Rs': 0.05018532251050574}, {'theta_Rs': 0.00015274348410889934, 'center_y': -1.702200571928675, 'center_x': 0.7879832229488578, 'r_trunc': 0.28229734432344517, 'Rs': 0.04169726604958409}, {'theta_Rs': 0.0005175260860564234, 'center_y': -2.488227606042316, 'center_x': -1.1735210675919603, 'r_trunc': 0.5054484596405671, 'Rs': 0.06439359686706259}, {'theta_Rs': 0.0004457402438883284, 'center_y': -1.4869848537822818, 'center_x': 1.7290005989694972, 'r_trunc': 0.4816620875981397, 'Rs': 0.07066552560182332}, {'theta_Rs': 0.0002508241398395839, 'center_y': 0.5149094653024621, 'center_x': -2.359298417549325, 'r_trunc': 0.3603647033335379, 'Rs': 0.052100824823401615}, {'theta_Rs': 0.001472915460153299, 'center_y': 1.3973811797228712, 'center_x': 1.4269632892773823, 'r_trunc': 0.8577046082969704, 'Rs': 0.11261100729529307}, {'theta_Rs': 0.0017214732123073783, 'center_y': 1.7922466914333135, 'center_x': -1.2097870206854684, 'r_trunc': 0.8833968938832012, 'Rs': 0.09164361262837639}, {'theta_Rs': 0.0002590814983532246, 'center_y': -0.42900899704943984, 'center_x': -1.237041362888265, 'r_trunc': 0.3816994933130564, 'Rs': 0.07092954438355543}, {'theta_Rs': 0.00019229836400394494, 'center_y': -1.3562466777560456, 'center_x': -2.1174372915051607, 'r_trunc': 0.3203022865570914, 'Rs': 0.050444498491393146}, {'kappa_ext': -0.00042028915060125804}, {'theta_Rs': 0.00030853065515138123, 'center_y': -1.0731996774002444, 'center_x': 2.564894774175292, 'r_trunc': 0.37157572210370293, 'Rs': 0.04428744716053436}, {'theta_Rs': 0.0001878607384317342, 'center_y': -1.150621706788159, 'center_x': -2.3481339311535394, 'r_trunc': 0.30450706908193403, 'Rs': 0.047088882038187854}, {'theta_Rs': 0.0006306778807863133, 'center_y': 0.6626509406990704, 'center_x': -1.338241956002509, 'r_trunc': 0.5744470790641714, 'Rs': 0.1065452502674738}, {'theta_Rs': 0.00026652760030449423, 'center_y': -0.6841067186263455, 'center_x': 2.365558977514267, 'r_trunc': 0.37962270945531723, 'Rs': 0.07917385280293865}, {'theta_Rs': 0.00026701054002773236, 'center_y': -0.03553764518710407, 'center_x': -1.204825875201293, 'r_trunc': 0.3580909351595, 'Rs': 0.05125334265960675}, {'theta_Rs': 0.004038757548138625, 'center_y': 1.6205412222493958, 'center_x': -2.4091841217784826, 'r_trunc': 1.2787696886628412, 'Rs': 0.12090633769869955}, {'kappa_ext': -0.0003341670932596444}, {'theta_Rs': 0.0010951257409636671, 'center_y': -0.9864946689700732, 'center_x': 0.8381873311916787, 'r_trunc': 0.6463914393571704, 'Rs': 0.06212122473044542}, {'theta_Rs': 0.00013884774692323834, 'center_y': -1.2308154290916213, 'center_x': -0.1996985637147031, 'r_trunc': 0.2528519682586603, 'Rs': 0.03880697037322772}, {'theta_Rs': 0.0005566870752929094, 'center_y': 1.208389681214727, 'center_x': 0.2259075952631238, 'r_trunc': 0.48932867091929527, 'Rs': 0.0624397974842222}, {'theta_Rs': 0.0005706284563247418, 'center_y': 0.5791520291776269, 'center_x': 0.6719392167539097, 'r_trunc': 0.5004891902916843, 'Rs': 0.06733258611107137}, {'theta_Rs': 0.0002763754129380002, 'center_y': 2.4942850110799726, 'center_x': -1.5772826530480912, 'r_trunc': 0.3537541338359912, 'Rs': 0.051767918623982744}, {'theta_Rs': 0.0017965536449671424, 'center_y': 2.3512977137032536, 'center_x': 1.2751934868753507, 'r_trunc': 0.8525916439936555, 'Rs': 0.09366676151689894}, {'theta_Rs': 0.0001849957504433336, 'center_y': 1.9242596179410114, 'center_x': 0.2560355454642562, 'r_trunc': 0.2882432656483912, 'Rs': 0.04123802508712719}, {'theta_Rs': 0.0004690927859593664, 'center_y': -0.9652631270768622, 'center_x': -0.2621422793119124, 'r_trunc': 0.4691419752385397, 'Rs': 0.0760988535621081}, {'theta_Rs': 0.00040960299346333857, 'center_y': -2.831948670586162, 'center_x': 0.035350374502931915, 'r_trunc': 0.42661639015798924, 'Rs': 0.05928415802305873}, {'kappa_ext': -0.00020409488264339692}, {'theta_Rs': 0.0001557044696823776, 'center_y': 1.8150833768974808, 'center_x': 2.235829469706146, 'r_trunc': 0.2590756007492149, 'Rs': 0.039369717791484106}, {'theta_Rs': 0.00019615986991599477, 'center_y': -1.6450305076716072, 'center_x': -1.8246551429262234, 'r_trunc': 0.2965352761317429, 'Rs': 0.05066293842739519}, {'theta_Rs': 0.0024306212972777246, 'center_y': 0.9481480584912185, 'center_x': -0.5516871123703382, 'r_trunc': 0.9581250645105139, 'Rs': 0.10369818178509281}, {'theta_Rs': 0.00019658350828304796, 'center_y': 0.4125568734797696, 'center_x': -2.387693821771086, 'r_trunc': 0.2887943655448466, 'Rs': 0.041957049823627544}, {'theta_Rs': 0.002023363320080272, 'center_y': 2.563513215574961, 'center_x': 0.889177806288512, 'r_trunc': 0.9061495189335023, 'Rs': 0.11691770125960445}, {'theta_Rs': 0.00018226954075369954, 'center_y': 0.8403981887949397, 'center_x': 2.1530705186860435, 'r_trunc': 0.27916758437586586, 'Rs': 0.04145258541492733}, {'theta_Rs': 0.00016579793135888162, 'center_y': 1.2386030449320142, 'center_x': 0.003540437695048157, 'r_trunc': 0.27146647385402867, 'Rs': 0.045172916625617794}, {'theta_Rs': 0.00015033373929720153, 'center_y': -1.2976020526950358, 'center_x': -0.8751627317888171, 'r_trunc': 0.25102509792740935, 'Rs': 0.03527881445859043}, {'theta_Rs': 0.0011505156986328575, 'center_y': -1.2265876101693813, 'center_x': -0.5466271080288906, 'r_trunc': 0.6683548373175161, 'Rs': 0.07724016388722085}, {'theta_Rs': 0.0006824283511953071, 'center_y': 0.10126033188993432, 'center_x': 2.7873876653977487, 'r_trunc': 0.5153556101703775, 'Rs': 0.05990301757969564}, {'theta_Rs': 0.000604029444635985, 'center_y': -2.1473115879058025, 'center_x': -0.21584496317742374, 'r_trunc': 0.48416981468355547, 'Rs': 0.05589700078127509}, {'theta_Rs': 0.0005988435576932024, 'center_y': -0.6885209576376408, 'center_x': -1.84868737426662, 'r_trunc': 0.4890946614585341, 'Rs': 0.060624997758441615}, {'theta_Rs': 0.00022659762496589212, 'center_y': -0.8781279743829581, 'center_x': -1.004895943735805, 'r_trunc': 0.3061016273019426, 'Rs': 0.04147903075017345}, {'theta_Rs': 0.0005338037709967299, 'center_y': -0.31286336546402305, 'center_x': -2.791980610624518, 'r_trunc': 0.46843695278490816, 'Rs': 0.062498790713852115}, {'kappa_ext': -0.0003960781085776705}, {'theta_Rs': 0.0003114318063979325, 'center_y': 1.5098870415852532, 'center_x': 2.3590268498648403, 'r_trunc': 0.3415204338021388, 'Rs': 0.04169969952040873}, {'theta_Rs': 0.0003508578488302447, 'center_y': 0.04003797314724268, 'center_x': -2.782382717202424, 'r_trunc': 0.3672464303506545, 'Rs': 0.04790705978689947}, {'theta_Rs': 0.00018513703571874351, 'center_y': 2.3708483215063807, 'center_x': 1.437364344377344, 'r_trunc': 0.27927642800837166, 'Rs': 0.04717494760448981}, {'theta_Rs': 0.0026881766973543882, 'center_y': -2.7985511017856863, 'center_x': -0.047061434958526, 'r_trunc': 1.014325227840289, 'Rs': 0.13084231504350388}, {'theta_Rs': 0.0006050097353645661, 'center_y': 1.021866928058866, 'center_x': 0.1896432676141487, 'r_trunc': 0.4833824460631639, 'Rs': 0.06382980521703911}, {'kappa_ext': -0.00021001671682201886}, {'theta_Rs': 0.00019523410218247672, 'center_y': 0.3331919828707945, 'center_x': 0.47494432064949205, 'r_trunc': 0.28526565291100514, 'Rs': 0.05574503445108665}, {'theta_Rs': 0.0002464559492136307, 'center_y': 1.6981405463022405, 'center_x': 1.8456876751160682, 'r_trunc': 0.2936873164566575, 'Rs': 0.034717138656179154}, {'theta_Rs': 0.00014036426876336036, 'center_y': 0.07123670978686149, 'center_x': -1.9746226452563453, 'r_trunc': 0.23547961460282152, 'Rs': 0.03861782350922113}, {'theta_Rs': 0.001056115186635672, 'center_y': 0.19138962391232395, 'center_x': -1.2988287283661377, 'r_trunc': 0.6128850885787199, 'Rs': 0.07540353002272969}, {'kappa_ext': -5.107437687422044e-05}, {'theta_Rs': 0.0002451109265008053, 'center_y': -0.32740522400963695, 'center_x': -2.477692268910255, 'r_trunc': 0.29743417003230377, 'Rs': 0.04352412045697889}, {'theta_Rs': 0.0003761764760751156, 'center_y': -1.741070020259228, 'center_x': 0.37736127193686453, 'r_trunc': 0.34311722804865924, 'Rs': 0.03516081396506784}, {'theta_Rs': 0.00012896013435502617, 'center_y': -0.6968077343326569, 'center_x': -1.2842184024186516, 'r_trunc': 0.224822831725297, 'Rs': 0.04237074372830459}, {'theta_Rs': 0.00033164153429178224, 'center_y': 0.8668198929774904, 'center_x': -1.1850857272313198, 'r_trunc': 0.3569075890469762, 'Rs': 0.0628969075242806}, {'theta_Rs': 0.0005669601805579191, 'center_y': 0.5107107227036054, 'center_x': 0.1288534810646999, 'r_trunc': 0.42888223792468244, 'Rs': 0.04777776908618451}, {'theta_Rs': 0.00016922414386492818, 'center_y': -1.2713734631375608, 'center_x': -1.5878419303896634, 'r_trunc': 0.2625714157718888, 'Rs': 0.05705100225947783}, {'theta_Rs': 0.00035959284777701693, 'center_y': 0.7749578523204669, 'center_x': -2.4239371099994935, 'r_trunc': 0.3775073778507172, 'Rs': 0.07395102067503995}, {'theta_Rs': 0.00035206724468678436, 'center_y': -2.602244045981337, 'center_x': 0.3988672724137359, 'r_trunc': 0.36786856081168356, 'Rs': 0.06498135884468376}, {'theta_Rs': 0.0002687502344445982, 'center_y': 2.1328108496884917, 'center_x': -0.8028084156456146, 'r_trunc': 0.3303602719951007, 'Rs': 0.07086900267877856}, {'kappa_ext': -6.732128341152529e-05}, {'theta_Rs': 0.001150359168839819, 'center_y': -0.566188477720377, 'center_x': 0.569700612893195, 'r_trunc': 0.6182065654784206, 'Rs': 0.08228016937300313}, {'theta_Rs': 0.00022684843565165958, 'center_y': -0.3658757819242472, 'center_x': 0.04148491979413774, 'r_trunc': 0.2792194354369103, 'Rs': 0.0407242838963996}, {'theta_Rs': 0.0005964769330536065, 'center_y': -0.5377747383312147, 'center_x': -1.599740054346926, 'r_trunc': 0.45472776103107543, 'Rs': 0.06795123815649862}, {'theta_Rs': 0.0005698110733918437, 'center_y': -2.109510592297679, 'center_x': -0.24626465708865533, 'r_trunc': 0.43074708211916996, 'Rs': 0.054435370430041215}, {'theta_Rs': 0.0011796513346146802, 'center_y': 0.2692582661397631, 'center_x': 0.6679088033423862, 'r_trunc': 0.6230640042635379, 'Rs': 0.08090375849873584}, {'theta_Rs': 0.00039734187412300846, 'center_y': 0.6973585585359846, 'center_x': -1.0641484897747733, 'r_trunc': 0.3430637038481957, 'Rs': 0.03458103908605072}, {'theta_Rs': 0.0002126614300050919, 'center_y': -0.32924675445431817, 'center_x': -2.3914652637670555, 'r_trunc': 0.26719720649166234, 'Rs': 0.0365598188284765}, {'kappa_ext': -0.0001418099684043021}, {'theta_Rs': 0.00022261538754143306, 'center_y': -1.4472504689413872, 'center_x': -1.4764424634353257, 'r_trunc': 0.2696197247564915, 'Rs': 0.03862122727886637}, {'theta_Rs': 0.0002688013846699631, 'center_y': -1.1324531899123877, 'center_x': 2.0668276864422834, 'r_trunc': 0.3024754722448103, 'Rs': 0.0487942458805691}, {'theta_Rs': 0.00020325260718674366, 'center_y': 1.8397839720754736, 'center_x': -0.23452089980221755, 'r_trunc': 0.2577211896134539, 'Rs': 0.03699082443986251}, {'theta_Rs': 0.0004884757053469318, 'center_y': 0.282412757594136, 'center_x': 0.18046134660693183, 'r_trunc': 0.39672886761332193, 'Rs': 0.054802722091031944}, {'theta_Rs': 0.0028180798220988207, 'center_y': -0.7085477797372683, 'center_x': -2.1756655111515193, 'r_trunc': 0.8971380308352578, 'Rs': 0.09212564586319176}, {'theta_Rs': 0.0005043121778599753, 'center_y': -0.9197030023751157, 'center_x': -0.1869627916559377, 'r_trunc': 0.4042508954823006, 'Rs': 0.05670096330090803}, {'theta_Rs': 0.00024597213853173156, 'center_y': -0.6828144610707175, 'center_x': -1.712849797353033, 'r_trunc': 0.2864048222960801, 'Rs': 0.04351758430108526}, {'theta_Rs': 0.0001679042069927503, 'center_y': 1.711074683821496, 'center_x': 1.1734716071827827, 'r_trunc': 0.23982157484763225, 'Rs': 0.039438286569004964}, {'theta_Rs': 0.0003669170340328863, 'center_y': 2.038412578710242, 'center_x': -0.20744873847668605, 'r_trunc': 0.3487060117337866, 'Rs': 0.05204624029504355}, {'kappa_ext': -0.00019946743942955984}, {'theta_Rs': 0.00016200943907806345, 'center_y': -0.5477802249152186, 'center_x': 2.0448468341124353, 'r_trunc': 0.2321539634767375, 'Rs': 0.03966344142064547}, {'theta_Rs': 0.00017258667104443022, 'center_y': 1.4151323409547236, 'center_x': 0.932059913578251, 'r_trunc': 0.24447363643679076, 'Rs': 0.04773995555879797}, {'theta_Rs': 0.0004878401460019895, 'center_y': -1.3656565794258628, 'center_x': 0.009249139144984243, 'r_trunc': 0.3788831418776803, 'Rs': 0.04610468798742251}, {'theta_Rs': 0.0005175990457302962, 'center_y': -1.278098938846961, 'center_x': 1.412801680722467, 'r_trunc': 0.39203236975383293, 'Rs': 0.04879366077257439}, {'theta_Rs': 0.0003379511610596054, 'center_y': 0.2927777095754904, 'center_x': -0.7512757982289422, 'r_trunc': 0.3237344698391266, 'Rs': 0.04512355422700286}, {'theta_Rs': 0.00032895599378360095, 'center_y': -2.1645428294141147, 'center_x': 0.2580063938398057, 'r_trunc': 0.3195921475911446, 'Rs': 0.04469350120145854}, {'theta_Rs': 0.00030480659748478487, 'center_y': -0.7290371941793016, 'center_x': 2.0095245934234454, 'r_trunc': 0.3178544987588137, 'Rs': 0.05369195515010644}, {'theta_Rs': 0.0001245014723298119, 'center_y': -1.9647893253416067, 'center_x': -0.6092950915674846, 'r_trunc': 0.21213391026354014, 'Rs': 0.04888760986082184}, {'kappa_ext': -5.3002698843759654e-05}, {'theta_Rs': 0.0001566511769553503, 'center_y': 0.31030895834717975, 'center_x': -1.557607010043873, 'r_trunc': 0.2260248540106819, 'Rs': 0.04103568896029717}, {'theta_Rs': 0.0003052946918277378, 'center_y': -0.35787818522619863, 'center_x': 0.5256345151778906, 'r_trunc': 0.29079717326689, 'Rs': 0.033550450794948}, {'theta_Rs': 0.001282496224577762, 'center_y': -1.211871279369133, 'center_x': -0.2664230504368017, 'r_trunc': 0.5907272143238285, 'Rs': 0.0653146574727926}, {'theta_Rs': 0.0008530260427069765, 'center_y': 1.0833639094771164, 'center_x': -0.9563621441906446, 'r_trunc': 0.48459501351394124, 'Rs': 0.05509057078934739}, {'theta_Rs': 0.0001592078264244734, 'center_y': 1.5404528556957744, 'center_x': 1.2162009382247307, 'r_trunc': 0.23266136136636487, 'Rs': 0.048976618684535844}, {'theta_Rs': 0.0004079936367823121, 'center_y': 2.009704716608788, 'center_x': 0.23583954894650325, 'r_trunc': 0.342123838751321, 'Rs': 0.043052968560296716}, {'theta_Rs': 0.0002794147864929796, 'center_y': 1.69315118778959, 'center_x': -0.05102059494147119, 'r_trunc': 0.29222708408677744, 'Rs': 0.04354281038255512}, {'theta_Rs': 0.0011085740164710669, 'center_y': -1.5516713438100993, 'center_x': 0.8554916820354963, 'r_trunc': 0.5543072214452596, 'Rs': 0.06405065134976723}, {'theta_Rs': 0.0006041040183342575, 'center_y': 1.2222013435327583, 'center_x': 0.26212403369526904, 'r_trunc': 0.426711591576152, 'Rs': 0.0611657495939789}, {'theta_Rs': 0.00027542901164762, 'center_y': 0.23081164127213621, 'center_x': 1.0716956326566212, 'r_trunc': 0.2934854758357201, 'Rs': 0.04673512185371979}, {'theta_Rs': 0.0002594466595239302, 'center_y': -0.46007675366648587, 'center_x': -0.9496950306852613, 'r_trunc': 0.282040909626624, 'Rs': 0.04240654930276566}, {'theta_Rs': 0.0007021534625025295, 'center_y': 0.9977973839203494, 'center_x': 0.6180478577177295, 'r_trunc': 0.4663203829873159, 'Rs': 0.07216646875352256}, {'theta_Rs': 0.00012121365822021827, 'center_y': -1.1683748904673141, 'center_x': -0.20737099810102858, 'r_trunc': 0.19339306130239134, 'Rs': 0.02961044601091366}, {'theta_Rs': 0.00023598557159548595, 'center_y': -0.9070230512165289, 'center_x': 0.5012559597178613, 'r_trunc': 0.2737592354454395, 'Rs': 0.04567001815800115}, {'theta_Rs': 0.0026017011657344016, 'center_y': -0.19328187344405767, 'center_x': -0.06844668483910687, 'r_trunc': 0.8526681808602863, 'Rs': 0.1005116831051219}, {'kappa_ext': -0.00032276436827399703}, {'theta_Rs': 0.0005482748011861173, 'center_y': -1.8396719902459648, 'center_x': -0.1858335977557751, 'r_trunc': 0.3822786934982243, 'Rs': 0.043846416421094644}, {'theta_Rs': 0.0009927366619962821, 'center_y': -1.369054311748628, 'center_x': -0.4101499983693974, 'r_trunc': 0.49724310649789455, 'Rs': 0.04875315988990271}, {'theta_Rs': 0.00011043269105170126, 'center_y': 0.9422036861276314, 'center_x': -0.899790820964092, 'r_trunc': 0.18791074029147825, 'Rs': 0.03605217056989324}, {'theta_Rs': 0.00028991747486321206, 'center_y': 0.36920404582556343, 'center_x': -0.9539344630135849, 'r_trunc': 0.2922840226618524, 'Rs': 0.043490103129277535}, {'theta_Rs': 0.0006844413338780818, 'center_y': 1.7017029067047116, 'center_x': 0.5144420801418811, 'r_trunc': 0.4421708630680475, 'Rs': 0.06042088112257066}, {'theta_Rs': 0.00029862135107422785, 'center_y': 0.03924592818916535, 'center_x': -1.4244851656733024, 'r_trunc': 0.28844929984137213, 'Rs': 0.03693093089303566}, {'theta_Rs': 0.00024257957623029138, 'center_y': -0.3425484028952841, 'center_x': 0.8382022083954336, 'r_trunc': 0.27042719662325704, 'Rs': 0.042981790029869876}, {'theta_Rs': 0.0004041509436041349, 'center_y': -1.0938430477738221, 'center_x': 1.3333710061420188, 'r_trunc': 0.3497937365489557, 'Rs': 0.056299646582650395}, {'theta_Rs': 0.00014153285200689644, 'center_y': -1.028552373288323, 'center_x': 0.00419757302163477, 'r_trunc': 0.20168219283658978, 'Rs': 0.02801061420755447}, {'kappa_ext': -8.873257747769045e-05}, {'theta_Rs': 0.000590922015287652, 'center_y': -0.5363107431642864, 'center_x': -1.807048073699375, 'r_trunc': 0.4160056433498875, 'Rs': 0.06699638041882386}, {'theta_Rs': 0.00017323860138286596, 'center_y': 0.07951274399267369, 'center_x': 0.563779929875131, 'r_trunc': 0.2309167012888991, 'Rs': 0.043589524212463815}, {'theta_Rs': 0.0008313756727163585, 'center_y': -0.7782224951306351, 'center_x': 0.5374637362773839, 'r_trunc': 0.4782367573815271, 'Rs': 0.06461119700318879}, {'theta_Rs': 0.00012278466069013273, 'center_y': -1.1978012807190148, 'center_x': 0.32156108750791446, 'r_trunc': 0.19362368009521058, 'Rs': 0.0355679778878495}, {'theta_Rs': 0.00017117408823046922, 'center_y': -0.6415929287109559, 'center_x': 1.0670455495250804, 'r_trunc': 0.21854360772983228, 'Rs': 0.030667428088615504}, {'theta_Rs': 0.00012729310518198015, 'center_y': 1.4271910715257066, 'center_x': 0.3655693338056438, 'r_trunc': 0.1908813241136618, 'Rs': 0.0287536169871523}, {'kappa_ext': -5.169626570998817e-05}, {'theta_Rs': 0.00015335483779094366, 'center_y': -0.21050236063302527, 'center_x': 1.4310302210410595, 'r_trunc': 0.21920767859959447, 'Rs': 0.04970529618567707}, {'theta_Rs': 0.003053330646492569, 'center_y': -1.4634490572922423, 'center_x': 0.8724004208602025, 'r_trunc': 0.9056100685600476, 'Rs': 0.12463644523421159}, {'theta_Rs': 0.00022177277876059154, 'center_y': 1.1469843977312684, 'center_x': -1.30161204951143, 'r_trunc': 0.26059934723340444, 'Rs': 0.05394957965289414}, {'theta_Rs': 0.00021818755722795755, 'center_y': -1.1202413188928884, 'center_x': 1.1205889197491632, 'r_trunc': 0.2382837623318857, 'Rs': 0.03019393045784177}, {'theta_Rs': 0.00011808407461015191, 'center_y': 0.8995961977448677, 'center_x': 1.2261044183847505, 'r_trunc': 0.1813310208940052, 'Rs': 0.027573268314541027}, {'theta_Rs': 0.00019816221485129248, 'center_y': -0.2571040852199262, 'center_x': 0.941826001347674, 'r_trunc': 0.24015563841238086, 'Rs': 0.04172879433086064}, {'theta_Rs': 0.00027873078675032665, 'center_y': -0.312967979756809, 'center_x': -1.010271154657355, 'r_trunc': 0.2794324960682566, 'Rs': 0.0432354907896848}, {'theta_Rs': 0.0005469568221483955, 'center_y': -1.6673434134922471, 'center_x': -0.5778358347699636, 'r_trunc': 0.38924582730092244, 'Rs': 0.058317793015611394}, {'kappa_ext': -0.00021538761536006487}, {'theta_Rs': 0.0019365218305575627, 'center_y': 0.03107236715331937, 'center_x': 1.6915881507920114, 'r_trunc': 0.693169391413425, 'Rs': 0.08368980063056744}, {'theta_Rs': 0.0019464761950659813, 'center_y': -0.871052431080381, 'center_x': -0.02935545619252867, 'r_trunc': 0.663865686138079, 'Rs': 0.0647054960238665}, {'theta_Rs': 0.00017558044890396697, 'center_y': 1.095640191070666, 'center_x': 0.5648019003163579, 'r_trunc': 0.21806498959857512, 'Rs': 0.033220456377095836}, {'theta_Rs': 0.00015715432435441603, 'center_y': 0.9451858282356547, 'center_x': 0.6532733156898651, 'r_trunc': 0.21425209441141177, 'Rs': 0.04142273610484996}, {'theta_Rs': 0.00034759920480430956, 'center_y': 1.4236962367499293, 'center_x': 0.8536624932806912, 'r_trunc': 0.29858152106891805, 'Rs': 0.03920907591466543}, {'theta_Rs': 0.0009428559196577377, 'center_y': -0.9105320680815331, 'center_x': 1.3787944940308472, 'r_trunc': 0.4836816325164742, 'Rs': 0.05840312325299631}, {'kappa_ext': -0.0001940939161886574}, {'theta_Rs': 0.0006454102827992435, 'center_y': 0.786075739155427, 'center_x': -1.0520415783926442, 'r_trunc': 0.39899784918092823, 'Rs': 0.050674495428272424}, {'kappa_ext': -1.620807076766063e-05}, {'theta_Rs': 0.00037786608647070373, 'center_y': 0.5534940216987878, 'center_x': -0.728897646783309, 'r_trunc': 0.3199072448985117, 'Rs': 0.05670366776654743}, {'theta_Rs': 0.00018950400888947881, 'center_y': -0.5086409809259449, 'center_x': -0.3008154221579976, 'r_trunc': 0.2173473551917138, 'Rs': 0.030197079783521593}, {'theta_Rs': 0.00019594367624437215, 'center_y': -0.6228864161746157, 'center_x': -1.03226911232361, 'r_trunc': 0.21785608165664802, 'Rs': 0.028063782883041934}, {'theta_Rs': 0.0008090165314265358, 'center_y': -0.18829309938344885, 'center_x': 0.35084130524958435, 'r_trunc': 0.43829537045245837, 'Rs': 0.053689257388336416}, {'kappa_ext': -3.611589840974863e-05}, {'theta_Rs': 0.0006521520630492452, 'center_y': -1.04415518576681, 'center_x': -0.03619458701121427, 'r_trunc': 0.3940319418583313, 'Rs': 0.05131244924264112}, {'theta_Rs': 0.00033546534819369346, 'center_y': -0.6062629160723778, 'center_x': 0.8460395844575354, 'r_trunc': 0.2985348446635373, 'Rs': 0.05329464880985924}, {'theta_Rs': 0.00011500431100224647, 'center_y': 0.5291099418113738, 'center_x': 0.5525434018876509, 'r_trunc': 0.17758125607376762, 'Rs': 0.035328768365863635}, {'theta_Rs': 0.0001400865042268816, 'center_y': 1.0480869324708701, 'center_x': -0.7951636463951746, 'r_trunc': 0.1917272731463365, 'Rs': 0.032898060387718794}, {'kappa_ext': -2.7103971068739946e-05}, {'theta_Rs': 0.00010888689538914399, 'center_y': -1.0209076395588983, 'center_x': -0.5918169000162176, 'r_trunc': 0.1684044866274513, 'Rs': 0.030007434139439192}, {'theta_Rs': 0.0006698511042291414, 'center_y': -0.3050447217651035, 'center_x': 0.9414709712681939, 'r_trunc': 0.409800559831575, 'Rs': 0.06488987419199134}, {'theta_Rs': 0.0008325079337257267, 'center_y': 0.7360327447663955, 'center_x': -0.05372594226916307, 'r_trunc': 0.43594124475343093, 'Rs': 0.0535776899161417}, {'kappa_ext': -4.2845137682303805e-05}, {'theta_Rs': 0.00038172716729246097, 'center_y': 0.4711633769502762, 'center_x': 0.9155532487064887, 'r_trunc': 0.31258551279262997, 'Rs': 0.05564302901132941}, {'theta_Rs': 0.0002297449268927929, 'center_y': -0.6615440839521611, 'center_x': -0.4584513588894821, 'r_trunc': 0.2430022559295595, 'Rs': 0.04384347554052478}, {'theta_Rs': 0.0005876530145325271, 'center_y': -0.530170669673988, 'center_x': 0.41573296467918835, 'r_trunc': 0.3664886063921059, 'Rs': 0.04717939516641334}, {'theta_Rs': 0.00040733192969912013, 'center_y': -0.2366077293453255, 'center_x': 0.9682981447946709, 'r_trunc': 0.3199012215523399, 'Rs': 0.053676890790596316}, {'theta_Rs': 0.0002928832315573482, 'center_y': -0.5917220644207702, 'center_x': 0.4426964473846541, 'r_trunc': 0.27037891389656066, 'Rs': 0.044469081221135874}, {'theta_Rs': 0.000165399238690354, 'center_y': -0.06971769399564688, 'center_x': -0.07170699552293014, 'r_trunc': 0.20770266071254936, 'Rs': 0.03937179063018504}, {'kappa_ext': -4.3740161375230085e-05}, {'theta_Rs': 0.0003468448315597643, 'center_y': 0.7753014220680957, 'center_x': -0.8069519307627648, 'r_trunc': 0.27901925986685744, 'Rs': 0.035625914564387566}, {'theta_Rs': 0.00025345699664017934, 'center_y': -0.25986375721239774, 'center_x': -0.03763390557876555, 'r_trunc': 0.24198286960335919, 'Rs': 0.03331950976283747}, {'theta_Rs': 0.001620614131451354, 'center_y': 0.2123932216168364, 'center_x': -0.6698787183352346, 'r_trunc': 0.608094392241532, 'Rs': 0.08101463983151885}, {'theta_Rs': 0.00010793700934949951, 'center_y': -0.25072835692878664, 'center_x': 0.49683163756638243, 'r_trunc': 0.16730466056471152, 'Rs': 0.03274472160495666}, {'kappa_ext': -7.483847596220243e-05}, {'theta_Rs': 0.00011841359428318822, 'center_y': -0.41200870545654855, 'center_x': 0.2043962878945203, 'r_trunc': 0.17405490045649874, 'Rs': 0.03397523928888711}, {'theta_Rs': 0.0005502052819823486, 'center_y': 0.9658675501242188, 'center_x': -0.5031766576418544, 'r_trunc': 0.3576509318610303, 'Rs': 0.05187162057930995}, {'theta_Rs': 0.0018945391520556096, 'center_y': -0.0875710931053677, 'center_x': -0.42000045637816213, 'r_trunc': 0.6251965438985112, 'Rs': 0.06707601033180634}, {'theta_Rs': 0.0001502465196750519, 'center_y': 0.5355432347897858, 'center_x': -0.50334433629029, 'r_trunc': 0.18661339402696273, 'Rs': 0.026840045878054518}, {'theta_Rs': 0.0012532310268294471, 'center_y': 0.16730343531102218, 'center_x': -0.6384197014908096, 'r_trunc': 0.558119251971886, 'Rs': 0.09880618860157699}, {'theta_Rs': 9.495403186019612e-05, 'center_y': 0.2174147932377888, 'center_x': 0.7897902564696786, 'r_trunc': 0.1519948408177583, 'Rs': 0.025160465236910047}, {'kappa_ext': -0.0001371361258940498}, {'theta_Rs': 0.00012505926945651204, 'center_y': -0.1563138015624123, 'center_x': 1.052816884874904, 'r_trunc': 0.17807703921573664, 'Rs': 0.03497479509984447}, {'kappa_ext': -1.6786664117473416e-06}, {'theta_Rs': 0.00014963444135384225, 'center_y': 0.44558346188077175, 'center_x': -0.05942981043751479, 'r_trunc': 0.18948637948189895, 'Rs': 0.03188189815429543}, {'theta_Rs': 0.0007372503253238982, 'center_y': 0.5470791389653874, 'center_x': 0.06074770424680333, 'r_trunc': 0.40202220147911877, 'Rs': 0.052443754927116025}, {'theta_Rs': 9.291958192227902e-05, 'center_y': 0.5919512306187641, 'center_x': -0.18821385009336342, 'r_trunc': 0.15197169397763552, 'Rs': 0.02867394768420175}, {'theta_Rs': 0.0009602360493026671, 'center_y': -0.7109143553116843, 'center_x': 0.4397978533646741, 'r_trunc': 0.45018476422878484, 'Rs': 0.05337551114218933}, {'theta_Rs': 0.0005911028052101357, 'center_y': -0.03109102834007672, 'center_x': 0.24537599917157968, 'r_trunc': 0.3732891041497611, 'Rs': 0.05952089903767673}, {'kappa_ext': -6.363020406763539e-05}, {'theta_Rs': 0.0002072264762350583, 'center_y': 0.10679048218459619, 'center_x': 0.2514783264468778, 'r_trunc': 0.22166149813582575, 'Rs': 0.036660232295252004}, {'theta_Rs': 0.00018188356420636756, 'center_y': -0.34173382959612386, 'center_x': 0.13014644308007536, 'r_trunc': 0.21269471682986957, 'Rs': 0.0411258701085938}, {'kappa_ext': -6.137276240857525e-06}, {'theta_Rs': 0.00015855531395590799, 'center_y': 0.11995310544714474, 'center_x': -0.18012627270828624, 'r_trunc': 0.19316698450161124, 'Rs': 0.031629764127900376}, {'kappa_ext': -2.1504347656138604e-06}, {'theta_Rs': 0.00013708809996077251, 'center_y': -0.7637202056295932, 'center_x': 0.2787102815756435, 'r_trunc': 0.1896246778621089, 'Rs': 0.04644886077233303}, {'kappa_ext': -2.117370083252343e-06}, {'theta_Rs': 8.427548498209794e-05, 'center_y': -0.2934087948498967, 'center_x': -0.1200526117216721, 'r_trunc': 0.14268176149669975, 'Rs': 0.02550369358015173}, {'theta_Rs': 0.0018058311027457335, 'center_y': -0.3763950352248771, 'center_x': 0.5646458646524708, 'r_trunc': 0.6286344808228742, 'Rs': 0.08429979810520616}, {'kappa_ext': -7.40855075608668e-05}, {'theta_Rs': 0.0001361521688241838, 'center_y': 0.007503416986394799, 'center_x': -0.4765543551834887, 'r_trunc': 0.17898121217574872, 'Rs': 0.029219538275061612}, {'theta_Rs': 0.00013691692655649798, 'center_y': 0.5435689893735148, 'center_x': 0.00407208800460754, 'r_trunc': 0.18224273260794063, 'Rs': 0.03274904388025707}, {'kappa_ext': -3.527021762051409e-06}, {'theta_Rs': 0.0008130634386295679, 'center_y': 0.5124997999298786, 'center_x': -0.4220492862102108, 'r_trunc': 0.44155406557827415, 'Rs': 0.0735877581917353}, {'kappa_ext': -2.5388019503768793e-05}, {'theta_Rs': 8.417404650409352e-05, 'center_y': -0.37065927654384356, 'center_x': -0.3531974650594943, 'r_trunc': 0.14178053738872412, 'Rs': 0.022648552349778996}, {'theta_Rs': 6.972499630851323e-05, 'center_y': 0.5392833091464185, 'center_x': -0.22920655830230266, 'r_trunc': 0.1291343423070662, 'Rs': 0.020719159058339525}, {'theta_Rs': 0.0001657037347350663, 'center_y': 0.016639758522668184, 'center_x': -0.3105286810588716, 'r_trunc': 0.19721776552118706, 'Rs': 0.029956952643068507}, {'kappa_ext': -3.6806492963343545e-06}, {'theta_Rs': 0.00017723170138196067, 'center_y': 0.14342866463520568, 'center_x': -0.054873081349856676, 'r_trunc': 0.20685524948100753, 'Rs': 0.032881632211616905}, {'theta_Rs': 0.000907940380978194, 'center_y': 0.5072333151032272, 'center_x': 0.10321322058307002, 'r_trunc': 0.4779580472493733, 'Rs': 0.08641679258473944}, {'kappa_ext': -3.423858822591646e-05}, {'theta_Rs': 0.00020482375935826122, 'center_y': 0.19536545899516533, 'center_x': -0.18807694853746978, 'r_trunc': 0.22777755419662363, 'Rs': 0.040038970221045536}, {'theta_Rs': 8.802702336252442e-05, 'center_y': 0.10369978624695808, 'center_x': 0.19723159910246155, 'r_trunc': 0.15210526585996623, 'Rs': 0.03031539562620555}, {'kappa_ext': -4.384948950859666e-06}, {'theta_Rs': 0.00012350462574711943, 'center_y': -0.3706464104501233, 'center_x': -0.11387481896351348, 'r_trunc': 0.17909752656148265, 'Rs': 0.0321663180986218}, {'kappa_ext': -1.6113764146061318e-06}, {'theta_Rs': 0.0002098834625248197, 'center_y': 0.007436856973790249, 'center_x': -0.20348754674306166, 'r_trunc': 0.23200242249426542, 'Rs': 0.03743942562703369}, {'kappa_ext': -3.3985772732891296e-06}, {'theta_Rs': 0.0009337116390731137, 'center_y': 0.07733598772714731, 'center_x': -0.3380704674829817, 'r_trunc': 0.46909738271614887, 'Rs': 0.056322736317820574}, {'theta_Rs': 6.095631155207042e-05, 'center_y': -0.2410141669414008, 'center_x': -0.11385843302544098, 'r_trunc': 0.1282932191919492, 'Rs': 0.02247762377490985}, {'kappa_ext': -2.74324610127521e-05}, {'theta_Rs': 6.91987268807618e-05, 'center_y': -0.08837672692600786, 'center_x': 0.0006041713527367665, 'r_trunc': 0.16579821269847747, 'Rs': 0.03004792104244329}, {'kappa_ext': -8.387432466328733e-07}, {'theta_Rs': 0.0020134774348886065, 'center_y': -0.6620776889547932, 'center_x': 0.776135600247332, 'r_trunc': 0.27694864462895297, 'Rs': 0.09695473269847417}, {'theta_Rs': 0.0002965990540116107, 'center_y': 1.3407192143474451, 'center_x': 2.0196615914565426, 'r_trunc': 0.18387983475569855, 'Rs': 0.050011146879597}, {'theta_Rs': 0.0003545736169139997, 'center_y': -0.8386909359707064, 'center_x': -1.5828068363940833, 'r_trunc': 0.5034421084703453, 'Rs': 0.052456652739278624}, {'theta_Rs': 0.0007191433655673394, 'center_y': 1.8011831546250219, 'center_x': -1.0601640129241832, 'r_trunc': 0.1493148107964595, 'Rs': 0.07631037740886595}, {'theta_Rs': 0.0012749053902443885, 'center_y': 0.26568738661234964, 'center_x': 0.7629282263617368, 'r_trunc': 0.18423941804504426, 'Rs': 0.1032159393021998}, {'theta_Rs': 0.0001724666697894191, 'center_y': 0.4568129008994801, 'center_x': 2.950074372371507, 'r_trunc': 0.237761328909694, 'Rs': 0.04455431699268935}, {'theta_Rs': 0.00029187489457755615, 'center_y': 1.9389021658627743, 'center_x': -0.8472084548092375, 'r_trunc': 0.15491830506467405, 'Rs': 0.04887307799544785}, {'theta_Rs': 0.00021126297579552553, 'center_y': 2.0893331333805736, 'center_x': 1.817888567526928, 'r_trunc': 0.10431559639350224, 'Rs': 0.05301133376978519}, {'theta_Rs': 0.001014480382051289, 'center_y': -1.2848675988524514, 'center_x': 0.3797881622693054, 'r_trunc': 0.3928485286276051, 'Rs': 0.07132900305521588}, {'theta_Rs': 0.0005484219899485091, 'center_y': -1.8132527306858495, 'center_x': 1.366226634704281, 'r_trunc': 0.14422059628220882, 'Rs': 0.0599008024379989}, {'theta_Rs': 0.00029927027483759775, 'center_y': -2.192790187407388, 'center_x': -0.5154402061594302, 'r_trunc': 0.41211085302309824, 'Rs': 0.06070905765836872}, {'theta_Rs': 0.0007832648194629181, 'center_y': 2.235147078189819, 'center_x': 0.6384048226550857, 'r_trunc': 0.39077661499554267, 'Rs': 0.06355398289684416}, {'theta_Rs': 0.000870123798059767, 'center_y': -0.4659359959404552, 'center_x': 2.8221401645458237, 'r_trunc': 0.25514970070405674, 'Rs': 0.060950877260024475}, {'theta_Rs': 0.00044268865924587946, 'center_y': 0.1701986080580272, 'center_x': 1.2919731155346812, 'r_trunc': 0.1619346113536512, 'Rs': 0.05049756296188032}, {'theta_Rs': 0.0010464731740917586, 'center_y': -2.6371834426818452, 'center_x': 0.8543487146658668, 'r_trunc': 0.43086394677415474, 'Rs': 0.07592817841491453}, {'theta_Rs': 0.001058635630608169, 'center_y': -2.5785194572227788, 'center_x': -0.3468910744102628, 'r_trunc': 0.26104772249433666, 'Rs': 0.07936058092435652}, {'theta_Rs': 0.0007648024080234218, 'center_y': 2.098936087651996, 'center_x': 0.32968526569602724, 'r_trunc': 0.2871388618183903, 'Rs': 0.05558572380190204}, {'theta_Rs': 0.00013905819265410703, 'center_y': -2.293938458349645, 'center_x': 0.30290471861217966, 'r_trunc': 0.1780283184037512, 'Rs': 0.05378910345588318}, {'theta_Rs': 0.0009744371952855668, 'center_y': -0.22993009398106315, 'center_x': 2.9673166228421937, 'r_trunc': 0.46528340573692495, 'Rs': 0.08458605023245967}, {'theta_Rs': 0.0001569646659838809, 'center_y': -0.4623645309982866, 'center_x': 1.4954775221946404, 'r_trunc': 0.12427620427102071, 'Rs': 0.03890320685583778}, {'theta_Rs': 0.00016938528899118144, 'center_y': 1.3230445035604317, 'center_x': 2.166695170267783, 'r_trunc': 0.11266307445432451, 'Rs': 0.04639892426800046}, {'theta_Rs': 0.000329420435123665, 'center_y': -1.165164703094893, 'center_x': -2.103908041112781, 'r_trunc': 0.20615316283857446, 'Rs': 0.05075359178402532}, {'theta_Rs': 0.00015273012961377426, 'center_y': 1.1166022985495123, 'center_x': -1.3272275480547209, 'r_trunc': 0.1814776061861322, 'Rs': 0.03559963167223293}, {'theta_Rs': 0.0002071111512447286, 'center_y': -0.11035076305026484, 'center_x': 2.7997199441930998, 'r_trunc': 0.14769220069383884, 'Rs': 0.053649497287436496}, {'theta_Rs': 0.00038427388378326367, 'center_y': 0.2537443890497703, 'center_x': 0.7823070185492588, 'r_trunc': 0.22416452173117443, 'Rs': 0.0632823733111459}, {'theta_Rs': 0.0015950507463956998, 'center_y': 1.2288804043276136, 'center_x': -2.673445090754504, 'r_trunc': 0.33734708940001473, 'Rs': 0.09885279430330449}, {'theta_Rs': 0.00012905108112959722, 'center_y': 1.0515249491419145, 'center_x': -2.747903864676625, 'r_trunc': 0.11024220317015329, 'Rs': 0.042632432440560655}, {'theta_Rs': 0.0002943173973116224, 'center_y': -2.1091062146113893, 'center_x': -1.5929887612008125, 'r_trunc': 0.11951321365750991, 'Rs': 0.052103643480616975}, {'theta_Rs': 0.00015130366890050626, 'center_y': 1.5398320289559717, 'center_x': -2.4170094041599963, 'r_trunc': 0.19441580119686927, 'Rs': 0.032955992938834965}, {'theta_Rs': 0.0002856168886646526, 'center_y': -0.7366128508248223, 'center_x': -0.24898766632634073, 'r_trunc': 0.08660567481061923, 'Rs': 0.04730150231440789}, {'theta_Rs': 0.0005001051071986009, 'center_y': -0.02144155945220231, 'center_x': -1.0456242287436486, 'r_trunc': 0.13908219782995335, 'Rs': 0.05798092654944478}, {'theta_Rs': 0.0003848772737924604, 'center_y': 0.8780328942145882, 'center_x': 0.7154575139817275, 'r_trunc': 0.11319084249693435, 'Rs': 0.05194170588039034}, {'theta_Rs': 0.0010054150002794787, 'center_y': -0.6992470509380699, 'center_x': -2.2146808131849727, 'r_trunc': 0.1993148579903859, 'Rs': 0.09091217061142712}, {'theta_Rs': 0.0023082054999805355, 'center_y': -2.6614460242371836, 'center_x': 0.7224811038215503, 'r_trunc': 0.4250554498681478, 'Rs': 0.11345528146466526}, {'theta_Rs': 0.0001342275220335515, 'center_y': 1.3009736665496359, 'center_x': 1.1712974673012417, 'r_trunc': 0.059667849141552536, 'Rs': 0.037780819031684135}, {'theta_Rs': 0.00028883223523789485, 'center_y': 2.091769939973479, 'center_x': 0.3537426122638331, 'r_trunc': 0.2508321002893561, 'Rs': 0.06451633780081997}, {'theta_Rs': 0.0004676006896855172, 'center_y': 0.18826706454475448, 'center_x': -2.0866404557235905, 'r_trunc': 0.29804012061489127, 'Rs': 0.05971067476351811}, {'theta_Rs': 0.000655599267106298, 'center_y': -1.6425576444101002, 'center_x': -1.2764790590467685, 'r_trunc': 0.28077356461174685, 'Rs': 0.0627738598298587}, {'theta_Rs': 0.0005934723450890967, 'center_y': 0.9022664446036637, 'center_x': -0.6580550853239414, 'r_trunc': 0.3660285507488, 'Rs': 0.053172649419205235}, {'theta_Rs': 0.0005171230426877849, 'center_y': -0.2636147438104657, 'center_x': -0.6359049334573118, 'r_trunc': 0.21664975625820548, 'Rs': 0.05886129463891386}, {'theta_Rs': 0.00042500703323526977, 'center_y': 0.2456733650383192, 'center_x': -1.6505144297007128, 'r_trunc': 0.31016122632700416, 'Rs': 0.057912584039650425}, {'theta_Rs': 0.0002443849077719331, 'center_y': 0.19346423077947084, 'center_x': 2.27841150634721, 'r_trunc': 0.10214529648014146, 'Rs': 0.04310616622960719}, {'theta_Rs': 0.00013697210932401527, 'center_y': 2.1651240223393664, 'center_x': 0.6755797699470376, 'r_trunc': 0.10588730462883049, 'Rs': 0.035459258585383735}, {'theta_Rs': 0.010859412361609888, 'center_y': -1.4696959143635362, 'center_x': 0.5950415210768377, 'r_trunc': 0.8958107395532408, 'Rs': 0.1757351011107103}, {'theta_Rs': 0.0001538764998188177, 'center_y': -0.41558029253540557, 'center_x': -1.1436342315062182, 'r_trunc': 0.12581133820559398, 'Rs': 0.04402605108387144}, {'theta_Rs': 0.00028806334523244785, 'center_y': 0.4557831170190513, 'center_x': 1.8472216088598985, 'r_trunc': 0.39742113697373754, 'Rs': 0.052203056081456436}, {'theta_Rs': 0.0001965101974363126, 'center_y': 1.9406025842057695, 'center_x': 1.6696144262905674, 'r_trunc': 0.12720301798837375, 'Rs': 0.06200219077112815}, {'theta_Rs': 0.0002849806417774782, 'center_y': 2.4351449970161303, 'center_x': -0.7163743920561666, 'r_trunc': 0.19891346768932971, 'Rs': 0.04956209958538072}, {'theta_Rs': 0.00017904187542008975, 'center_y': -2.3127204467097155, 'center_x': 0.9123518780106394, 'r_trunc': 0.14977421624871415, 'Rs': 0.04257798656856014}, {'theta_Rs': 0.00013795756520688566, 'center_y': 0.9875901986914529, 'center_x': 0.6291667384352648, 'r_trunc': 0.07214959684892089, 'Rs': 0.039470913892506614}, {'theta_Rs': 0.0006334492371234822, 'center_y': 2.213619952793423, 'center_x': -1.636654985122047, 'r_trunc': 0.2923367044838161, 'Rs': 0.07708897190870524}]

    optimizer_simple = Optimizer(x_pos, y_pos, magnification_target=magnification, redshift_list=redshift_list_simple,
                                 lens_model_list=lens_model_list_simple, kwargs_lens=kwargs_lens_simple, multiplane=False, verbose=False)

    optimizer_subs = Optimizer(x_pos, y_pos, magnification_target=magnification, redshift_list=redshift_list_subs,
                               lens_model_list=lens_model_list_subs, kwargs_lens=kwargs_lens_subs, multiplane=False, verbose=False)

    def test_multi_plane_incorrect_model(self,tol=0.003):
        """
        The data was created with a full LOS realization, so the simple lens model is actually incorrect
        :param tol: image position tolerance
        :return:
        """
        kwargs_lens, source, [x_image,y_image] = self.optimizer_simple.optimize(n_particles=50,n_iterations=200)
        index = sort_image_index(x_image, y_image, self.x_pos, self.y_pos)

        x_image = x_image[index]
        y_image = y_image[index]

        dx = np.absolute(x_image - self.x_pos)
        dy = np.absolute(y_image - self.y_pos)

        # magnifications will be super-wrong
        npt.assert_array_less(dx, [tol] * len(dx))
        npt.assert_array_less(dy, [tol] * len(dy))

    def test_multi_plane_correct_model(self):
        """
        Should be a near perfect fit since the LOS model is the same used to create the data.
        :return:
        """
        kwargs_lens, source, [x_image,y_image] = self.optimizer_subs.optimize(n_particles=50,n_iterations=200)
        index = sort_image_index(x_image, y_image, self.x_pos, self.y_pos)
        x_image = x_image[index]
        y_image = y_image[index]

        mags = self.optimizer_subs.optimizer_amoeba.lensModel.magnification(x_image, y_image, kwargs_lens)
        mags = np.absolute(mags)
        mags *= max(mags) ** -1

        # everything should match
        npt.assert_almost_equal(x_image, self.x_pos, decimal=4)
        npt.assert_almost_equal(y_image, self.y_pos, decimal=4)
        npt.assert_almost_equal(self.magnification, mags, decimal=2)

if __name__ == '__main__':
    pytest.main()

